(()=>{var j=(o=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(o,{get:(s,n)=>(typeof require<"u"?require:s)[n]}):o)(function(o){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+o+'" is not supported')});function v(o=f=>f,{imports:s,message:n,transfer:e,port:t,blocking:d,pool:R,loop:p,animate:u,callback:S}={}){return new Promise((f,W)=>{let T;if(typeof o!="function"){if(typeof o=="string"&&o.startsWith("./")){let g=location.origin,i=location.pathname.split("/");i.pop();let c=i.join("/");c.startsWith("http")?g+="/":g+=c+"/",o=g+o}T=o}else T=V(o,s);let M=g=>{let i={},c=!1;g.onmessage=l=>{for(let r in i)i[r](l.data.message,l.data.cb)},g.onerror=l=>{console.error(new Error("Worker encountered an error: "+l.message))};let h=(l,r,a)=>new Promise((m,O)=>{if(!a&&g.PORTS)g.postMessage({message:l,overridePort:a},r),m(!0);else{if(d){if(c)return new Promise((P,K)=>{K("Thread Blocked")});c=!0}let b=Math.random();i[b]=(P,K)=>{b===K&&(delete i[b],d&&(c=!1),m(P))},g.postMessage({message:l,cb:b,overridePort:a},r)}}),E={run:(l,r,a)=>h(l,r,a),terminate:()=>{if(URL.revokeObjectURL(T),g.terminate(),g.PORTS){let l=(r,a)=>{r.postMessage({COMMAND:{DELETED:g.id}})};g.PORTS.forEach(l)}},addPort:l=>C(g,l,d),addCallback:(l=a=>{},r)=>{let a=Math.random();return i[a]=r?m=>{l(m),delete i[a]}:l,a},removeCallback:l=>{delete E.callbacks[l]},setLoop:(l,r,a)=>{g.postMessage({message:r,COMMAND:{SETLOOP:l}},a)},setAnimation:(l,r)=>{g.postMessage({message:l,COMMAND:{SETANIM:!0}},r)},stop:()=>{g.postMessage({COMMAND:{STOP:!0}})},worker:g,callbacks:i,id:g.id};return S&&E.addCallback(S),p?E.setLoop(p,n,e):u&&E.setAnimation(n,e),E};if(R){let g=function(){let E=new Worker(T,s||typeof o!="function"?{type:"module"}:void 0),l=Math.random();return E.id=l,i[l]=E,l},i={},c={};for(let E=0;E<R;E++)g();let h=Object.keys(i);if(t&&h.forEach((E,l)=>{let r=i[E];Array.isArray(t)?t.length===h.length?C(r,t[l],d):t.forEach(a=>{C(r,a,d)}):C(r,t,d)}),n&&!p&&!u)Promise.all(h.map((E,l)=>{let r=i[E],a=Array.isArray(n)?n[l]:n;return new Promise((m,O)=>{r.onmessage=P=>{Promise.resolve().then(()=>{r.terminate(),delete i[r.id]}),m(P.data.message)},r.onerror=P=>{Promise.resolve().then(()=>{r.terminate(),delete i[r.id]}),O(new Error("Worker encountered an error: "+P.message))};let b={message:a,oneOff:!0};r.postMessage(b,e)})})).then(E=>{URL.revokeObjectURL(T),f(E)}).catch(E=>{URL.revokeObjectURL(T),Object.keys(i).map((l,r)=>{let a=i[l];a&&a.terminate(),delete i[l],delete c.helpers?.[l]}),W(E)});else{let E=0;Object.assign(c,{workers:i,helpers:{},keys:h,run:(r,a,m,O)=>{if(O)return c.helpers[O]?.run(r,a);if(Array.isArray(r)){let b=r.length,P=[];for(let K=0;K<b;K++){let x=c.helpers[h[E]].run(r[K],a[K],m);E++,E>=h.length&&(E=0),P.push(x)}return P}else{let b=c.helpers[h[E]].run(r,a,m);return E++,E>=h.length&&(E=0),b}},terminate:r=>{function a(m){c.helpers[m]?.terminate(),delete c.helpers[m],delete c.workers[m]}r?a(r):h.forEach(a)},addWorker:()=>{let r=g(),a=i[r];return l(a),h.length=0,h.push(...h),r},addPort:(r,a)=>{function m(O){return c.helpers[O]?.addPort(r),!0}return a?m(a):h.map(m)},addCallback:(r,a,m)=>{function O(b){return c.helpers[b]?.addCallback(r,a)}return m?O(m):h.map(O)},removeCallback:(r,a)=>{function m(O){return c.helpers[O]?.removeCallback(r),!0}return a?m(a):h.map(m)},setLoop:(r,a,m,O)=>{function b(P){c.helpers[P]?.setLoop(r,a,m)}return O?b(O):h.map(b)},setAnimation:(r,a,m)=>{function O(b){c.helpers[b]?.setAnimation(r,a)}return m?O(m):h.map(O)},stop:r=>{function a(m){c.helpers[m]?.stop()}return r?a(r):h.map(a)}});let l=r=>{c.helpers[r.id]=M(r)};Object.keys(i).forEach((r,a)=>{l(i[r])}),f(c)}}else{let g=Math.random(),i=new Worker(T,s||typeof o!="function"?{type:"module"}:void 0);if(i.id=g,t&&(t.id||(t.id=Math.random()),Array.isArray(t)?t.map(c=>{C(i,c,d)}):C(i,t,d)),n&&!p&&!u)i.onmessage=c=>{Promise.resolve().then(()=>{i.terminate(),URL.revokeObjectURL(T)}),f(c.data.message)},i.onerror=c=>{Promise.resolve().then(()=>{i.terminate(),URL.revokeObjectURL(T)}),W(new Error("Worker encountered an error: "+c.message))},i.postMessage({message:n,oneOff:!0},e);else{let c=M(i);f(c)}}})}function U(o){let s=location.pathname.split("/");s.pop();let n=location.origin+s.join("/")+"/";return typeof o=="string"?(o.startsWith("./")&&(o=n+o),o.includes("import")?`${o}`:`import '${o}';`):Array.isArray(o)?o.map(e=>(e.startsWith("./")&&(e=n+e),e.includes("import")?e:`import '${e}';`)).join(`
`):typeof o=="object"?Object.entries(o).map(([e,t])=>(e.startsWith("./")&&(e=n+e),typeof t=="string"?`import ${t} from '${e}';`:typeof t=="boolean"&&t?`import '${e}'`:`import { ${Object.entries(t).map(([d,R])=>typeof R=="string"?`${d} as ${R}`:d).join(", ")} } from '${e}';`)).join(`
`)+"":""}function C(o,s,n){let e=new MessageChannel;o.id||(o.id=Math.random()),s.id||(s.id=Math.random()),o.postMessage({COMMAND:{SENDER:e.port1,id:s.id,blocking:n}},[e.port1]),s.postMessage({COMMAND:{RECEIVER:e.port2,id:o.id,blocking:n}},[e.port2]),o.PORTS||(o.PORTS=[]),o.PORTS.push(s),s.PORTS||(s.PORTS=[]),s.PORTS.push(o)}var F=(o=()=>{})=>{globalThis.WORKER={},o=o.bind(globalThis.WORKER);let s=(e,t,d,R)=>{if(globalThis.WORKER.SENDERS&&R!==!0)if(R!==void 0&&R!=="both")globalThis.WORKER.SENDERS[R]&&(e?.message?globalThis.WORKER.SENDERS[R].postMessage({message:e.message,overridePort:e?.overridePort},e.transfer):globalThis.WORKER.SENDERS[R].postMessage({message:e,overridePort:e?.overridePort}));else{for(let p in globalThis.WORKER.SENDERS){if(globalThis.WORKER.BLOCKING[p]){if(globalThis.WORKER.BLOCKED[p]){console.error("Thread Blocked: "+p);continue}globalThis.WORKER.BLOCKED[p]=!0}e?.message?globalThis.WORKER.SENDERS[p].postMessage({message:e.message,overridePort:e?.overridePort},e.transfer):globalThis.WORKER.SENDERS[p].postMessage({message:e,overridePort:e?.overridePort})}d&&postMessage(!0)}(!globalThis.WORKER.SENDERS||R===!0||R==="both")&&(e?.message?postMessage({message:e.message,cb:t,overridePort:e?.overridePort},e.transfer):postMessage({message:e,cb:t,overridePort:e?.overridePort}))},n=(e,t)=>{let d=o(e.data?.message);d?.then?d.then(R=>{t&&t.postMessage(!0),s(R,e.data.cb,e.data.oneOff,e.data.overridePort)}):(t&&t.postMessage(!0),s(d,e.data.cb,e.data.oneOff,e.data.overridePort))};globalThis.onmessage=e=>{if(e.data?.COMMAND){let t=e.data.COMMAND;if(typeof t.SETLOOP=="number"){globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP);let d=()=>{n(e),globalThis.WORKER.LOOP=setTimeout(()=>{d()},t.SETLOOP)};d()}if(t.SETANIM){globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM);let d=()=>{n(e),globalThis.WORKER.ANIM=requestAnimationFrame(()=>{d()})};d()}if(t.STOP&&(globalThis.WORKER.LOOP&&clearTimeout(globalThis.WORKER.LOOP),globalThis.WORKER.ANIM&&cancelAnimationFrame(globalThis.WORKER.ANIM)),t.RECEIVER){let d=t.blocking;globalThis.WORKER.RECEIVERS||(globalThis.WORKER.RTCR=0,globalThis.WORKER.RECEIVERS={});let R=t.id;globalThis.WORKER.RECEIVERS[R]=t.RECEIVER,globalThis.WORKER.RTCR++,t.RECEIVER.onmessage=p=>{n(p,d?t.RECEIVER:void 0)},t.RECEIVER.onerror=p=>{delete globalThis.WORKER.RECEIVERS[R]}}if(t.SENDER){globalThis.WORKER.SENDERS||(globalThis.WORKER.PCTR=0,globalThis.WORKER.SENDERS={},globalThis.WORKER.BLOCKING={},globalThis.WORKER.BLOCKED={});let d=t.blocking,R=t.id?t.id:globalThis.WORKER.PCTR;globalThis.WORKER.SENDERS[R]=t.SENDER,globalThis.WORKER.PCTR++,d&&(globalThis.WORKER.BLOCKING[R]=!0),t.SENDER.onmessage=p=>{globalThis.WORKER.BLOCKING[R]&&(globalThis.WORKER.BLOCKED[R]=!1)},t.SENDER.onerror=p=>{delete globalThis.WORKER.SENDERS[R]}}t.DELETED&&(delete globalThis.WORKER.RECEIVERS?.[t.DELETED],delete globalThis.WORKER.SENDERS?.[t.DELETED])}else n(e)},globalThis.onerror=e=>{console.error(e)}},B=F.toString(),V=(o,s)=>{let n=B.replace("()=>{}",o.toString()),e=`${U(s)}

(${n})()`,t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)};var L={},D;if(typeof process<"u")try{typeof L<"u"&&(globalThis.__filename=fileURLToPath(L.url),globalThis.__dirname=fileURLToPath(new URL(".",L.url))),D=j("path").join(process.cwd(),__dirname,"dist","onnx.worker.js")}catch{}else{let s=globalThis.location.href.split("/");s.pop(),s=s.join("/"),D=s+"/dist/onnx.worker.js"}var A=D;var I,G=async()=>{I=await v(A,{pool:2})};G();var w=document.createElement("button"),y=document.createElement("canvas"),N=y.getContext("2d",{willReadFrequently:!0}),k=document.createElement("canvas"),$=k.getContext("2d",{willReadFrequently:!0});document.body.appendChild(w);document.body.insertAdjacentHTML("beforeend","<br/>");y.style.width="50%";document.body.appendChild(y);k.style.width="50%";document.body.appendChild(k);var _=async(o,s,n)=>{let e=I.run({image:o,width:s,height:n},[o.buffer]);console.time("result1");let t=await e;console.timeEnd("result1"),k.width=s,k.height=n;let d=q(t,s,n),R=new ImageData(d,s,n);$.putImageData(R,0,0)};w.innerText="Load Image";w.addEventListener("click",()=>{let o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async s=>{let n=s.target.files[0];if(n){let e=new Image;e.onload=async()=>{y.width=e.width,y.height=e.height,N.drawImage(e,0,0);let t=N.getImageData(0,0,e.width,e.height);await _(t.data,e.width,e.height)},e.src=URL.createObjectURL(n)}},o.click()});function ee(o,s,n){let e=s*n,t=new Float32Array(e*3),d=new Uint32Array(o.buffer),R=0,p=e,u=2*e;for(let S=0;S<e;S++){let f=d[S],W=(f&255)/255,T=(f>>8&255)/255,M=(f>>16&255)/255;t[R++]=W,t[p++]=T,t[u++]=M}return t}function te(o,s,n){let e=s*n,t=new Float32Array(e*3),d=.485,R=.229,p=.456,u=.224,S=.406,f=.225,W=new Uint32Array(o.buffer),T=0,M=e,g=2*e;for(let i=0;i<e;i++){let c=W[i],h=(c&255)/255,E=(c>>8&255)/255,l=(c>>16&255)/255;t[T++]=(h-d)/R,t[M++]=(E-p)/u,t[g++]=(l-S)/f}return t}function q(o,s,n){let e=s*n,t=new Uint8ClampedArray(e*4),d=0,R=e,p=2*e;for(let u=0;u<e;u++){let S=o[d++],f=o[R++],W=o[p++];t[u*4]=S,t[u*4+1]=f,t[u*4+2]=W,t[u*4+3]=255}return t}})();
